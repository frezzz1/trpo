@startuml
!define C4P https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master
!include C4P/C4_Context.puml

Person(cl, "Клиент", "Регистрируется, накапливает и тратит бонусы, участвует в акциях, просматривает историю.")
Person(mm, "Менеджер по маркетингу", "Создает и управляет программами лояльности и акциями, анализирует их эффективность.")
Person(adm, "Администратор", "Управляет пользователями, модерирует контент, настраивает глобальные параметры системы.")

System(loyalty_system, "Система Управления Лояльностью", "Централизованная система для программ лояльности, начисления бонусов и аналитики.")

System_Ext(crm, "CRM-система", "Внешняя система управления взаимоотношениями с клиентами. Содержит основную клиентскую базу.")
System_Ext(erp_pos, "ERP / POS-система", "Внешняя система учета и продаж. Инициатор операций (покупок/возвратов) для начисления/списания баллов.")
System_Ext(payment_gateway, "Платежный шлюз", "Внешняя платежная система для проведения операций с бонусами или деньгами.")
System_Ext(email_sms, "Сервис коммуникаций", "Внешний сервис для отправки email и SMS (уведомления, рекламные рассылки).")

Rel(cl, loyalty_system, "Регистрируется, авторизуется, использует бонусы, участвует в акциях")
Rel(mm, loyalty_system, "Создает и управляет акциями, анализирует отчеты, сегментирует клиентов")
Rel(adm, loyalty_system, "Управляет правами, настраивает систему, модерирует акции")

Rel(loyalty_system, crm, "Синхронизирует профили клиентов, обновляет статусы лояльности", "REST API")
Rel(erp_pos, loyalty_system, "Передает данные о покупках для начисления/списания баллов", "REST API / событие")
Rel(loyalty_system, payment_gateway, "Инициирует списание средств или выплаты бонусов", "REST API")
Rel(loyalty_system, email_sms, "Отправляет уведомления о бонусах, акциях, персональные предложения", "REST API / SMTP")
@enduml